# BMI30 Vendor Bulk Oscilloscope ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ó–∞–ø—É—Å–∫–∞

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### Python –ø–∞–∫–µ—Ç—ã
```bash
pip install pyusb pyqtgraph PyQt5 numpy
# –ò–ª–∏ (–µ—Å–ª–∏ PyQt5 –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç):
pip install pyusb pyqtgraph PySide6 numpy
```

### USB –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- **VID:PID**: `0xCAFE:0x4001`
- **Interface**: `IF#2`
- **Endpoints**: OUT 0x03, IN 0x83
- **–†–µ–∂–∏–º**: Vendor Bulk —Å—Ç–µ—Ä–µ–æ (A/B –ø–∞—Ä—ã, –ø—Ä–æ—Ñ–∏–ª–∏ 1‚Äì2)

### –°–∏—Å—Ç–µ–º–∞
- **Linux** (–∏–ª–∏ macOS/Windows —Å libusb)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É (–ª–∏–±–æ —á–µ—Ä–µ–∑ `sudo`, –ª–∏–±–æ —á–µ—Ä–µ–∑ udev-–ø—Ä–∞–≤–∏–ª–æ)

---

## –ó–∞–ø—É—Å–∫ GUI –û—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–∞

```bash
cd /home/techaid/Documents
python3 BMI30.200.py
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è USB**:
   - –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ `0xCAFE:0x4001`
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ IF#2
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ alt=1 (Bulk endpoints active)
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º —á–µ—Ä–µ–∑ EP0 GET_STATUS

2. **Handshake**:
   - –û–∂–∏–¥–∞–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤: `alt1=1` –∏ `out_armed=1` (–∏–∑ STAT v1)
   - –û—á–∏—Å—Ç–∫–∞ HALT –Ω–∞ EP0x03/0x83
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥: `SET_PROFILE`, `SET_FRAME_SAMPLES`, `START_STREAM`

3. **–ü–æ—Ç–æ–∫–æ–≤–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ**:
   - –û–∂–∏–¥–∞–Ω–∏–µ A/B –ø–∞—Ä —Å—Ç–µ—Ä–µ–æ-–¥–∞–Ω–Ω—ã—Ö
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –¥–≤—É—Ö PyQtGraph –≥—Ä–∞—Ñ–∏–∫–∞—Ö (ADC0, ADC1)
   - X-–æ—Å—å = –∏–Ω–¥–µ–∫—Å—ã —Å–µ–º–ø–ª–æ–≤ (–Ω–µ –≤—Ä–µ–º—è)
   - Y-–æ—Å—å = –∞–º–ø–ª–∏—Ç—É–¥–∞ (–∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ~200 FPS (–ø—Ä–∏ profile=1, full=True)

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GUI

### –õ–µ–≥–µ–Ω–¥–∞ (–≤–µ—Ä—Ö–Ω—è—è —Å—Ç—Ä–æ–∫–∞)
- **–õ–µ–≤—ã–π –∫—Ä–∞–π**: `BUF=XXX FREQ=200Hz` ‚Äî —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞, —á–∞—Å—Ç–æ—Ç–∞
- **–í—ã–±–æ—Ä —á–∞—Å—Ç–æ—Ç—ã**: –ö–æ–º–±–æ–±–æ–∫—Å `200 Hz` / `300 Hz`
- **–ö–Ω–æ–ø–∫–∞ ‚Üª**: –†—É—á–Ω–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
- **–ö–Ω–æ–ø–∫–∞ ‚ö°**: –ü–µ—Ä–µ–∑–∞–ø–∏—Ç –ø–∏—Ç–∞–Ω–∏—è USB-–ø–æ—Ä—Ç–∞ (uhubctl, —Ç—Ä–µ–±—É–µ—Ç `sudo`)
- **–ö–Ω–æ–ø–∫–∞ ü©∫**: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ EP0/STAT, SOFT_RESET/DEEP_RESET, –ø—Ä–æ–≤–µ—Ä–∫–∞ alt/out_armed

### –ì—Ä–∞—Ñ–∏–∫
- **–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** –Ω–∞ –∫—Ä–∏–≤–æ–π: –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–∏–º–≤–æ–ª—ã (—Ç–æ—á–∫–∏)
- **–ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å** –ø–æ X/Y: –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –º—ã—à—å—é**: –∑—É–º–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- **–ó–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ** –∏–ª–∏ **Ctrl+C** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

---

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ü—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
   ```bash
   lsusb | grep -i "cafe:4001"
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞:
   ```bash
   # –õ–∏–±–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å sudo:
   sudo python3 BMI30.200.py
   
   # –õ–∏–±–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ udev-–ø—Ä–∞–≤–∏–ª–æ (–¥–ª—è –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞):
   sudo tee /etc/udev/rules.d/99-bmi30.rules << 'EOF'
   SUBSYSTEMS=="usb", ATTRS{idVendor}=="cafe", ATTRS{idProduct}=="4001", MODE="0666"
   EOF
   sudo udevadm control --reload-rules
   sudo udevadm trigger
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: "No suitable interface with EP 0x83/0x3"

1. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (alt=0)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **ü©∫** (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞), —á—Ç–æ–±—ã –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
3. –ò–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Ç–∞–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–Ω–æ–ø–∫–æ–π **‚ö°** (—Ç—Ä–µ–±—É–µ—Ç `uhubctl`)

### –ü—Ä–æ–±–ª–µ–º–∞: "EIO / Input/Output error"

1. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ EP0x03 –±—ã–ª –∑–∞–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (HALT)
2. GUI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç CLEAR_HALT –ø–æ—Å–ª–µ alt=1
3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ firmware –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ"

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **ü©∫** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (—Ç–µ—Ä–º–∏–Ω–∞–ª) –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫: `[diag]`, `[stream]`, `[err]`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ `alt=1` –∏ `out_armed=1`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `profile` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 1 (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ)

### –ü—Ä–æ–±–ª–µ–º–∞: "–ß–∞—Å—Ç—ã–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"

1. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é USB
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª—å –∏ –ø–æ—Ä—Ç USB
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π USB-–ø–æ—Ä—Ç
4. –°–Ω–∏–∑—å—Ç–µ `profile` —Å 1 –Ω–∞ 0 (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª: `BMI30.200.py` (—Å—Ç—Ä–æ–∫–∏ ~105‚Äì110)
```python
BMI30_PROFILE = 1  # 0=slow, 1=fast
BMI30_FULL_MODE = True  # True=FULL_MODE (–≤—Å–µ —Å–µ–º–ø–ª—ã), False=DIAG_MODE (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ)
BMI30_Y_AUTO = 0  # 0=fixed Y-range, 1=auto-scale Y
BMI30_Y_MIN = -32768
BMI30_Y_MAX = 32767
```

### –§–∞–π–ª: `USB_config.json` (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
```json
{
  "profile": 1,
  "freq": 200,
  "frame_samples": 32
}
```

---

## –†–µ–∂–∏–º—ã –ü—Ä–æ—Ñ–∏–ª—è (DevProfile)

| Profile | Mode | Rate (Hz) | Samples/Sec | Frame Size |
|---------|------|-----------|------------|------------|
| 0 | DIAG | 200 | ~1360 | 680B |
| 1 | FULL | 200 | ~1360 | 680B |
| 2 | FULL | 300 | ~912 | 456B |

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ STAT v1 (EP0 GET_STATUS –æ—Ç–≤–µ—Ç, 64 –±–∞–π—Ç–∞)

```
Byte Offset | Field Name     | Type  | –û–ø–∏—Å–∞–Ω–∏–µ
0‚Äì4         | sig            | [u8]  | "STAT"
4           | version        | u8    | 1 (STAT v1)
5           | reserved0      | u8    | 0
6‚Äì8         | cur_samples    | u16LE | –¢–µ–∫—É—â–∏–π –Ω–æ–º–µ—Ä —Å–µ–º–ø–ª–∞ –≤ –±—É—Ñ–µ—Ä–µ
8‚Äì10        | frame_bytes    | u16LE | –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞ –≤ –±–∞–π—Ç–∞—Ö
10‚Äì12       | test_frames    | u16LE | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–µ–π–º–æ–≤
12‚Äì16       | produced_seq   | u32LE | –ù–æ–º–µ—Ä –ø—Ä–æ–¥—É—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞
16‚Äì20       | sent0          | u32LE | –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ—Ä–µ–π–º–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ 0
20‚Äì24       | sent1          | u32LE | –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ—Ä–µ–π–º–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ 1
24‚Äì28       | dbg_tx_cplt    | u32LE | DMA –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π
28‚Äì32       | dbg_partial_frame_abort | u32LE | –û—Ç–º–µ–Ω –Ω–µ–ø–æ–ª–Ω—ã—Ö —Ñ—Ä–µ–π–º–æ–≤
32‚Äì36       | dbg_size_mismatch | u32LE | –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π —Ä–∞–∑–º–µ—Ä–∞
36‚Äì40       | dma_done0      | u32LE | DMA done —Å—á—ë—Ç—á–∏–∫ 0
40‚Äì44       | dma_done1      | u32LE | DMA done —Å—á—ë—Ç—á–∏–∫ 1
44‚Äì48       | frame_wr_seq   | u32LE | –ù–æ–º–µ—Ä –∑–∞–ø–∏—Å—ã–≤–∞–µ–º–æ–≥–æ —Ñ—Ä–µ–π–º–∞
48‚Äì50       | flags_runtime  | u16LE | Bit2=hang_latched, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤
50‚Äì52       | flags2         | u16LE | Bit15=alt1, Bits[14:0]=service
52          | sending_ch     | u8    | 0=A, 1=B, 0xFF=idle
53          | reserved2      | u8    | Bit7=out_armed, Bits[1:0]=deep_reset_count_mod4
54‚Äì56       | pair_idx       | u16LE | –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π –ø–∞—Ä—ã
56‚Äì58       | last_tx_len    | u16LE | –†–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–µ—Ä–µ–¥–∞—á–∏
58‚Äì62       | cur_stream_seq | u32LE | –¢–µ–∫—É—â–∏–π –Ω–æ–º–µ—Ä –ø–æ—Ç–æ–∫–∞
62‚Äì64       | reserved3      | u16LE | –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–ª–∞–≥–∏ –¥–ª—è handshake

- **alt1**: `(flags2[50:52] >> 15) & 1` ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≥–æ—Ç–æ–≤–æ –∫ alt=1
- **out_armed**: `(reserved2[53] >> 7) & 1` ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≥–æ—Ç–æ–≤–æ –ø–æ–ª—É—á–∞—Ç—å OUT –∫–æ–º–∞–Ω–¥—ã

---

## –§–æ—Ä–º–∞—Ç A/B –ü–∞—Ä—ã –°—Ç–µ—Ä–µ–æ

–ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —Ñ—Ä–µ–π–º–æ–≤ (A –∏ B) –ø–æ **680 –±–∞–π—Ç** (profile=1):

```
Frame Header (4 –±–∞–π—Ç–∞):
  Byte 0: 0xAA (–º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞)
  Byte 1: Seq (0‚Äì255, —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π)
  Byte 2: Type (0x00=TYPE_A, 0x01=TYPE_B)
  Byte 3: Reserved

–î–∞–Ω–Ω—ã–µ (676 –±–∞–π—Ç):
  338 —Å–µ–º–ø–ª–æ–≤ √ó 2 –±–∞–π—Ç–∞ –Ω–∞ —Å–µ–º–ø–ª (int16LE)
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è A/B

- –ö–∞–∂–¥—ã–π —Ç–∏–ø (A –∏ B) –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç A, –∑–∞—Ç–µ–º B, –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä—è–µ—Ç
- Tolerance: ¬±5 —Ñ—Ä–µ–π–º–æ–≤ –Ω–∞ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ (–¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π DMA)

---

## –ü—Ä–∏–º–µ—Ä—ã –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (–∫–æ–Ω—Å–æ–ª—å)

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫
```
[init] ‚Üê detected device 0xCAFE:0x4001
[init] ‚Üí IF#2 claimed, alt=0
[init] ‚Üí alt=1 set via SET_INTERFACE
[wait] ‚Üê alt1=1, out_armed=1 (STAT ready)
[clear] ‚Üí HALT cleared on 0x03/0x83
[tx] cmd=0x14 n=3  ‚Üê SET_PROFILE OK
[tx] cmd=0x20 n=1  ‚Üê START_STREAM OK
[stream] ‚Üê A[seq=1] (680B), B[seq=1] (680B), pairs=1, FPS=200
```

### EIO –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```
[tx-err] cmd=0x20 try=1 err=USBError(-1, 'error sending control message: Input/output error')
[tx-diag] alt1=1, out_armed=1 ‚Üí CLEAR_HALT + retry
[clear] ‚Üí HALT cleared on 0x03/0x83
[wait] ‚Üê alt1=1, out_armed=1 (ready after CLEAR_HALT)
[tx] cmd=0x20 n=1  ‚Üê START_STREAM OK (retry succeeded)
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Firmware –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

- **Interface IF#2** —Å Bulk Endpoints (OUT 0x03, IN 0x83)
- **STAT v1** —Ñ–æ—Ä–º–∞—Ç –Ω–∞ EP0 GET_STATUS (64 –±–∞–π—Ç–∞, sig="STAT", ver=1)
- **–ê/B –ø–∞–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Å—á—ë—Ç—á–∏–∫–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **SET_INTERFACE (0x0B/0x01)** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ alt-switching
- **Vendor SET_ALT (0x31)** –∫–∞–∫ fallback (–¥–ª—è legacy —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
- **OUT_ARMED —Ñ–ª–∞–≥** –≤ reserved2[53] bit7, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ alt=1

---

## –ë—ã—Å—Ç—Ä—ã–µ –ö–æ–º–∞–Ω–¥—ã

### –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```bash
# –ü–µ—Ä–µ–∑–∞–ø–∏—Ç–∞—Ç—å USB-–ø–æ—Ä—Ç (—Ç—Ä–µ–±—É–µ—Ç sudo –∏ uhubctl)
sudo uhubctl -l 1-1 -p 3 -a cycle
sleep 2
python3 BMI30.200.py
```

### –û—Ç–ª–∞–¥–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å smoke-—Ç–µ—Å—Ç (–µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ)
python3 << 'PY'
from usb_vendor.usb_stream import USBStream
stream = USBStream(profile=1, full=True)
for i in range(10):
    pairs = stream.get_stereo(timeout=0.1)
    if pairs:
        print(f"Pair {i}: {len(pairs)} frames, seq_a={stream.seq_a}, seq_b={stream.seq_b}")
stream.close()
PY
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤
lsusb

# –î–µ—Ç–∞–ª–∏ –Ω–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
lsusb -d cafe:4001 -v

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ USB —Ç—Ä–∞—Ñ–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç usbmon)
sudo modprobe usbmon
sudo chown $USER /dev/usbmon*
wireshark -i usbmon0 &  # –∏–ª–∏ tcpdump -i usbmon0
```

---

## –§–∞–π–ª—ã –ü—Ä–æ–µ–∫—Ç–∞

- **BMI30.200.py** ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π GUI (PyQtGraph + Qt)
- **usb_vendor/usb_stream.py** ‚Äî USB —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, handshake, A/B —Å–±–æ—Ä–∫–∞
- **USB_config.json** ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–æ—Ñ–∏–ª—å, —á–∞—Å—Ç–æ—Ç–∞)
- **plot_config.json** ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ (—Ü–≤–µ—Ç–∞, –º–∞—Å—à—Ç–∞–±)
- **History/** ‚Äî –ê—Ä—Ö–∏–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π
- **Cline/MCP/** ‚Äî Model Context Protocol –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

## –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è BMI30 Vendor Bulk Stereo —ç–º–∏—Ç—Ç–µ—Ä–∞.
–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è STAT v1 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–º firmware.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025 (session with STAT v1 spec validation)
